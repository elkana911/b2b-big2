

Query utk B2C yg nampilin 1 harga termurah
select A.FLIGHTAVAILID,A.FLIGHTNUM AS FLIGHT_NUMBER,A.ORIGIN,A.DESTINATION,
TO_CHAR(A.DEP_TIME, 'MM/DD/YYYY HH24:MI:SS A.M.') AS DEPARTURE_TIME,
TO_CHAR(A.ARR_TIME, 'MM/DD/YYYY HH24:MI:SS A.M.') AS ARRIVAL_TIME,
A.AIRLINE AS AIRLINE,A.ISTRANSIT,A.CURRENCY,
(SELECT MIN( B.CLASS_RATE) AS RATE   FROM FLIGHT_CLASS_FARE B
WHERE B.FLIGHTAVAILID = A.FLIGHTAVAILID AND B.CLASS_RATE>0 
AND CLASS_AVAIL_SEAT>0 AND B.CLASS_RATE IS NOT NULL ) 
AS PRICE
FROM FLIGHTAVAILSEAT A ;


Query utk B2B yg nampilin berdasarkan class
SELECT A.flightavailID,A.FLIGHTNUM AS FLIGHT_NUMBER,A.ORIGIN,A.DESTINATION,
TO_CHAR(A.DEP_TIME, 'MM/DD/YYYY HH24:MI:SS A.M.') AS DEPARTURE_TIME,
TO_CHAR(A.ARR_TIME, 'MM/DD/YYYY HH24:MI:SS A.M.') AS ARRIVAL_TIME,
A.AIRLINE AS AIRLINE,A.ISTRANSIT,
listagg (B.class_name, ',') WITHIN GROUP (ORDER BY B.class_sequence) Class_Seat,
listagg (B.class_rate, ',') WITHIN GROUP (ORDER BY B.class_sequence) Class_Rate,
listagg (B.class_avail_seat, ',') WITHIN GROUP (ORDER BY B.class_sequence) Class_Seat,
listagg (B.radio_id, ',') WITHIN GROUP (ORDER BY B.class_sequence) Radio_ID        
FROM FLIGHTAVAILSEAT A JOIN FLIGHT_CLASS_FARE B 
ON A.FLIGHTAVAILID= B.FLIGHTAVAILID
WHERE  ORIGIN='CGK' AND DESTINATION='SUB' 
AND TRUNC(DEP_TIME)=TO_DATE('17/11/2014','DD/MM/YYYY') AND DEP_TIME > sysdate+(2/24) 
GROUP BY A.flightavailID,A.FLIGHTNUM,A.ORIGIN,A.DESTINATION,A.DEP_TIME,
A.ARR_TIME,a.airline,A.ISTRANSIT;



